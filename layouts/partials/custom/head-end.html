<style>
  /* 导航栏工具栏：浮动在页面顶层，确保不消失 */
  .wq-mobile-controls {
    display: none; position: fixed; top: 0; right: 8px;
    height: 64px; z-index: 1000001; align-items: center; gap: 4px;
  }
  @media (max-width: 768px) {
    .wq-mobile-controls { display: flex; }
    .wq-ctrl-btn {
      width: 42px; height: 42px; display: flex; align-items: center; justify-content: center;
      background: transparent; border: none; color: currentColor; border-radius: 12px; cursor: pointer;
    }
    .wq-ctrl-btn svg { width: 22px; height: 22px; opacity: 0.85; }
  }

  /* 抽屉容器 */
  #wqMobileDrawer {
    position: fixed; inset: 0; z-index: 2000000; display: none;
    background: rgba(0,0,0,0.3); backdrop-filter: blur(15px); -webkit-backdrop-filter: blur(15px);
  }
  #wqMobileDrawer.on { display: block; }

  .wq-mm-sheet {
    position: absolute; top: 12px; right: 12px; bottom: 12px;
    width: min(85vw, 320px);
    background: rgba(255,255,255,0.92); border: 1px solid rgba(0,0,0,0.08);
    border-radius: 26px; box-shadow: 0 20px 60px rgba(0,0,0,0.18);
    transform: translateX(110%);
    transition: transform 0.4s cubic-bezier(0.32, 0.72, 0, 1);
    display: flex; flex-direction: column; padding: 22px;
  }
  html.dark .wq-mm-sheet { 
    background: rgba(28, 28, 30, 0.95); border-color: rgba(255,255,255,0.1); 
  }
  #wqMobileDrawer.on .wq-mm-sheet { transform: translateX(0); }

  /* 菜单项布局 */
  .wq-mm-list { display: flex; flex-direction: column; gap: 6px; }
  .wq-mm-item {
    display: flex; align-items: center; justify-content: space-between;
    padding: 13px 15px; border-radius: 14px; background: rgba(0,0,0,0.03);
    color: inherit; text-decoration: none !important; font-weight: 600; font-size: 15px;
  }
  html.dark .wq-mm-item { background: rgba(255,255,255,0.06); }
  .wq-mm-item-left { display: flex; align-items: center; gap: 12px; }
  .wq-mm-icon { width: 20px; height: 20px; display: flex; align-items: center; opacity: 0.8; }
</style>

<div class="wq-mobile-controls">
  <button class="wq-ctrl-btn" id="wqFinalSearch" aria-label="搜索">
    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><circle cx="11" cy="11" r="8"/><path d="m21 21-4.3-4.3"/></svg>
  </button>
  <button class="wq-ctrl-btn" id="wqFinalMenu" aria-label="菜单">
    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><line x1="3" y1="12" x2="21" y2="12"/><line x1="3" y1="6" x2="21" y2="6"/><line x1="3" y1="18" x2="21" y2="18"/></svg>
  </button>
</div>

<script>
(function () {
  const icons = {
    home: '<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"/><polyline points="9 22 9 12 15 12 15 22"/></svg>',
    docs: '<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/><polyline points="14 2 14 8 20 8"/></svg>',
    cloud: '<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M17.5 19A3.5 3.5 0 0 0 21 15.5c0-1.63-1.11-3.03-2.62-3.41L18 12c.03-.33.05-.66.05-1a5.5 5.5 0 0 0-11-1l.05 1c-1.51.38-2.6 1.78-2.6 3.41A3.5 3.5 0 0 0 8 19h9.5z"/></svg>',
    about: '<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><path d="M12 16v-4"/><path d="M12 8h.01"/></svg>',
    mail: '<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect width="20" height="16" x="2" y="4" rx="2"/><path d="m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7"/></svg>',
    github: '<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22"/></svg>',
    twitter: '<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M22 4s-.7 2.1-2 3.4c1.6 10-9.4 17.3-18 11.6 2.2.1 4.4-.6 6-2C3 15.5.5 9.6 3 5c2.2 2.6 5.6 4.1 9 4-.9-4.2 4-6.6 7-3.8 1.1 0 3-1.2 3-1.2z"/></svg>'
  };

  document.getElementById('wqFinalSearch').onclick = function() {
    // 调用 Hextra 全局搜索：模拟快捷键
    const event = new KeyboardEvent('keydown', { key: 'k', code: 'KeyK', metaKey: true, ctrlKey: true, bubbles: true });
    document.dispatchEvent(event);
    // 兼容性：尝试直接聚焦输入框
    const input = document.querySelector('input.hextra-search-input');
    if(input) { input.focus(); input.click(); }
  };

  document.getElementById('wqFinalMenu').onclick = function() {
    ensureDrawerDOM();
    const drawer = document.getElementById('wqMobileDrawer');
    drawer.style.display = 'block';
    setTimeout(() => drawer.classList.add('on'), 10);
    document.documentElement.style.overflow = 'hidden';
  };

  function closeWQDrawer() {
    const drawer = document.getElementById('wqMobileDrawer');
    if (drawer) {
      drawer.classList.remove('on');
      document.documentElement.style.overflow = '';
      setTimeout(() => drawer.style.display = 'none', 400);
    }
  }

  function ensureDrawerDOM() {
    if (document.getElementById('wqMobileDrawer')) return;
    const div = document.createElement('div');
    div.id = 'wqMobileDrawer';
    div.innerHTML = `
      <div class="wq-mm-sheet">
        <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:24px; padding:0 4px;">
          <span style="font-size:19px; font-weight:800; color:var(--wq-text);">导航</span>
          <button id="wqCloseBtn" style="background:none; border:none; font-size:26px; cursor:pointer; color:inherit;">×</button>
        </div>
        <div class="wq-mm-list">
          <a class="wq-mm-item" href="/"><div class="wq-mm-item-left"><span class="wq-mm-icon">${icons.home}</span>首页</div><span>›</span></a>
          <a class="wq-mm-item" href="/docs"><div class="wq-mm-item-left"><span class="wq-mm-icon">${icons.docs}</span>文档</div><span>›</span></a>
          <a class="wq-mm-item" href="https://pan.qinghub.top" target="_blank"><div class="wq-mm-item-left"><span class="wq-mm-icon">${icons.cloud}</span>网盘</div><span>›</span></a>
          <a class="wq-mm-item" href="/about"><div class="wq-mm-item-left"><span class="wq-mm-icon">${icons.about}</span>关于</div><span>›</span></a>
          <a class="wq-mm-item" href="mailto:wangqing176176@gmail.com"><div class="wq-mm-item-left"><span class="wq-mm-icon">${icons.mail}</span>联系</div><span>›</span></a>
          <div style="margin: 18px 0 8px 12px; font-size: 11px; opacity: 0.4; font-weight: 800; text-transform: uppercase; letter-spacing:1px;">Social</div>
          <a class="wq-mm-item" href="https://github.com/wangqing176176-a11y" target="_blank"><div class="wq-mm-item-left"><span class="wq-mm-icon">${icons.github}</span>GitHub</div><span>›</span></a>
          <a class="wq-mm-item" href="https://x.com/Whisky_0802" target="_blank"><div class="wq-mm-item-left"><span class="wq-mm-icon">${icons.twitter}</span>Twitter</div><span>›</span></a>
        </div>
        <div style="margin-top:auto; font-size:11px; opacity:0.3; text-align:center; padding-top:20px;">WANGQING'S BLOG</div>
      </div>
    `;
    div.onclick = (e) => { if(e.target === div) closeWQDrawer(); };
    document.body.appendChild(div);
    document.getElementById('wqCloseBtn').onclick = closeWQDrawer;
  }
})();
</script>