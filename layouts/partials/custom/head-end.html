<!-- ===== Apple é£ï¼šé¦–é¡µè®¿é—®æç¤ºå¼¹çª—ï¼ˆä»…é¦–é¡µ + é¦–æ¬¡è®¿é—®ï¼‰ ===== -->
<style>
  :root{
    --wq-mask: rgba(0,0,0,.38);
    --wq-card-bg: rgba(255,255,255,.78);
    --wq-card-border: rgba(0,0,0,.08);
    --wq-text: rgba(17,24,39,.95);
    --wq-subtext: rgba(17,24,39,.68);
    --wq-link: #2563eb;
    --wq-shadow: 0 24px 60px rgba(0,0,0,.18);
    --wq-radius: 20px;
    --wq-btn-bg: #111827;
    --wq-btn-text: #fff;
    --wq-btn-ghost-bg: rgba(17,24,39,.06);
    --wq-btn-ghost-text: rgba(17,24,39,.88);
  }

  html.dark{
    --wq-mask: rgba(0,0,0,.55);
    --wq-card-bg: rgba(24,24,27,.72);
    --wq-card-border: rgba(255,255,255,.10);
    --wq-text: rgba(255,255,255,.92);
    --wq-subtext: rgba(255,255,255,.68);
    --wq-link: #7aa2ff;
    --wq-shadow: 0 24px 70px rgba(0,0,0,.45);
    --wq-btn-bg: rgba(255,255,255,.92);
    --wq-btn-text: rgba(0,0,0,.88);
    --wq-btn-ghost-bg: rgba(255,255,255,.10);
    --wq-btn-ghost-text: rgba(255,255,255,.88);
  }

  .wq-modal{
    position: fixed;
    inset: 0;
    z-index: 9999;
    display: none;
    align-items: center;
    justify-content: center;
    padding: 18px;
    background: var(--wq-mask);
    backdrop-filter: blur(6px);
    -webkit-backdrop-filter: blur(6px);
  }

  .wq-card{
    width: min(560px,100%);
    background: var(--wq-card-bg);
    border: 1px solid var(--wq-card-border);
    border-radius: var(--wq-radius);
    box-shadow: var(--wq-shadow);
    overflow: hidden;
    transform: translateY(10px) scale(.98);
    opacity: 0;
    transition: transform .25s ease, opacity .25s ease;
  }

  .wq-modal.show .wq-card{
    transform: translateY(0) scale(1);
    opacity: 1;
  }

  /* è½»å¾®éœ‡åŠ¨åé¦ˆ */
  .wq-shake{
    animation: wq-shake .28s ease;
  }
  @keyframes wq-shake{
    0%{transform:translateX(0)}
    25%{transform:translateX(-4px)}
    50%{transform:translateX(4px)}
    75%{transform:translateX(-3px)}
    100%{transform:translateX(0)}
  }

  .wq-header{
    padding: 18px 18px 10px;
  }
  .wq-title{
    display:flex;
    align-items:center;
    gap:10px;
    font-size:16px;
    font-weight:700;
    color:var(--wq-text);
  }
  .wq-badge{
    width:34px;height:34px;
    border-radius:12px;
    display:grid;
    place-items:center;
    background:rgba(255,255,255,.55);
    border:1px solid var(--wq-card-border);
  }
  html.dark .wq-badge{background:rgba(255,255,255,.10)}

  .wq-body{
    padding:0 18px 16px;
    font-size:14.5px;
    line-height:1.75;
    color:var(--wq-text);
  }
  .wq-body p{margin:10px 0}
  .wq-body a{
    color:var(--wq-link);
    font-weight:600;
    text-decoration:none;
  }

  .wq-note{
    margin-top:12px;
    padding:12px;
    border-radius:14px;
    border:1px solid var(--wq-card-border);
    background:rgba(255,255,255,.45);
  }
  html.dark .wq-note{background:rgba(255,255,255,.06)}

  .wq-agree-row{
    display:flex;
    gap:10px;
    cursor:pointer;
    user-select:none;
  }
  .wq-agree-row input{
    margin-top:3px;
    width:16px;height:16px;
    accent-color:var(--wq-link);
  }
  .wq-agree-row span{
    color:var(--wq-subtext);
    line-height:1.6;
  }

  .wq-actions{
    padding:14px 18px 18px;
    display:flex;
    gap:10px;
    justify-content:flex-end;
    border-top:1px solid var(--wq-card-border);
    background:rgba(255,255,255,.25);
  }
  html.dark .wq-actions{background:rgba(255,255,255,.03)}

  .wq-btn{
    border:1px solid var(--wq-card-border);
    border-radius:14px;
    padding:10px 14px;
    font-size:14px;
    cursor:pointer;
  }
  .wq-btn-ghost{
    background:var(--wq-btn-ghost-bg);
    color:var(--wq-btn-ghost-text);
  }
  .wq-btn-primary{
    background:var(--wq-btn-bg);
    color:var(--wq-btn-text);
    border-color:transparent;
  }
  .wq-btn[disabled]{
    opacity:.55;
    cursor:not-allowed;
  }
</style>

<div class="wq-modal" id="wqModal" aria-hidden="true">
  <div class="wq-card" id="wqCard">
    <div class="wq-header">
      <div class="wq-title">
        <div class="wq-badge">ğŸ“Œ</div>
        è®¿é—®æç¤º
      </div>
    </div>

    <div class="wq-body">
      <p>
        ä½¿ç”¨æœ¬ç«™å‰ï¼Œè¯·å…ˆé˜…è¯»
        <a href="/about/">ã€Šå…³äºã€‹</a>
        é¡µé¢ä¸­çš„ç›¸å…³è¯´æ˜ã€‚
      </p>
      <p>ç»§ç»­è®¿é—®å’Œæ“ä½œï¼Œå³è§†ä¸ºæ‚¨åŒæ„ç›¸å…³çº¦å®šã€‚</p>

      <div class="wq-note">
        <label class="wq-agree-row">
          <input id="wqAgree" type="checkbox">
          <span>
            æˆ‘å·²ç†è§£å¹¶åŒæ„ï¼Œç¡®è®¤ç»§ç»­è®¿é—®ã€‚
          </span>
        </label>
      </div>
    </div>

    <div class="wq-actions">
      <a class="wq-btn wq-btn-ghost" href="/about/">æŸ¥çœ‹å…³äº</a>
      <button class="wq-btn wq-btn-primary" id="wqModalOk" disabled>
        è¿›å…¥ç½‘ç«™
      </button>
    </div>
  </div>
</div>

<script>
document.addEventListener("DOMContentLoaded", function () {
  var path = location.pathname || "/";
  if (path !== "/" && path !== "/index.html") return;

  var KEY = "wq_first_visit_modal_v1";
  if (localStorage.getItem(KEY) === "1") return;

  var modal = document.getElementById("wqModal");
  var card = document.getElementById("wqCard");
  var ok = document.getElementById("wqModalOk");
  var agree = document.getElementById("wqAgree");

  if (!modal || !card || !ok || !agree) return;

  ok.disabled = true;

  function show(){
    modal.style.display = "flex";
    requestAnimationFrame(function(){
      modal.classList.add("show");
    });
    document.documentElement.style.overflow = "hidden";
  }

  function shake(){
    card.classList.remove("wq-shake");
    card.offsetWidth;
    card.classList.add("wq-shake");
  }

  function hide(){
    if (!agree.checked){
      shake();
      return;
    }
    modal.classList.remove("show");
    document.documentElement.style.overflow = "";
    setTimeout(function(){
      modal.style.display = "none";
    },200);
    localStorage.setItem(KEY,"1");
  }

  agree.addEventListener("change",function(){
    ok.disabled = !agree.checked;
  });

  ok.addEventListener("click", hide);

  modal.addEventListener("click",function(e){
    if (e.target === modal) hide();
  });

  document.addEventListener("keydown",function(e){
    if (e.key === "Escape") hide();
  });

  show();
});
</script>
<!-- ===== å¼¹çª—ç»“æŸ ===== -->





{{- if .IsPage -}}
<!-- ===== WQ: inject article meta under H1 (Lastmod + ReadingTime) [PILL STYLE] ===== -->
<style>
  .hx-article-meta{
    margin-top: 1.35rem;          /* âœ… ä¸æ ‡é¢˜æ‹‰å¼€ä¸€ç‚¹ */
    margin-bottom: 2.0rem;
    padding-bottom: 1.1rem;
    border-bottom: 1px solid rgba(0,0,0,.06);
    display: flex;
    align-items: center;
    gap: .6rem;
    flex-wrap: wrap;
    color: rgba(100,116,139,1);
    font-size: .92rem;
    line-height: 1.6;
  }
  html.dark .hx-article-meta{
    border-bottom-color: rgba(255,255,255,.10);
    color: rgba(209,213,219,.80);
  }

  /* âœ… pill ç»Ÿä¸€æ ·å¼ï¼ˆApple-ishï¼šè½»ã€åœ†ã€å…‹åˆ¶ï¼‰ */
  .hx-article-meta .wq-pill{
    display: inline-flex;
    align-items: center;
    gap: .45rem;
    padding: .32rem .58rem;
    border-radius: 999px;
    border: 1px solid rgba(0,0,0,.06);
    background: rgba(148,163,184,.10);
    white-space: nowrap;
  }
  html.dark .hx-article-meta .wq-pill{
    border-color: rgba(255,255,255,.10);
    background: rgba(255,255,255,.06);
  }

  /* âœ… æ ‡ç­¾æ–‡å­—ï¼šåˆ«å¤ªé»‘ï¼Œç•¥åŠ ç²—ä½†â€œç°â€ */
  .hx-article-meta .wq-key{
    font-weight: 700;
    color: rgba(100,116,139,.95); /* ç° */
  }
  html.dark .hx-article-meta .wq-key{
    color: rgba(209,213,219,.88);
  }

  /* âœ… å€¼ï¼šæ›´æ·¡ä¸€ç‚¹ï¼Œé¿å…æŠ¢æ ‡é¢˜ */
  .hx-article-meta .wq-val{
    color: rgba(100,116,139,.90);
    font-variant-numeric: tabular-nums;
  }
  html.dark .hx-article-meta .wq-val{
    color: rgba(209,213,219,.80);
  }

  /* âœ… å·¦ä¾§å°åœ†ç‚¹ï¼šæ›´å…‹åˆ¶ */
  .hx-article-meta .wq-dot{
    width: 7px;
    height: 7px;
    border-radius: 999px;
    background: rgba(37,99,235,.55);
    box-shadow: 0 0 0 3px rgba(37,99,235,.10);
    display: inline-block;
    flex: 0 0 auto;
  }
  html.dark .hx-article-meta .wq-dot{
    background: rgba(96,165,250,.65);
    box-shadow: 0 0 0 3px rgba(96,165,250,.14);
  }

  /* æ‰‹æœºç«¯ï¼špill è‡ªåŠ¨æ¢è¡Œå°±å¥½ï¼Œä¸æŒ¤ */
  @media (max-width: 520px){
    .hx-article-meta{ gap: .5rem; }
    .hx-article-meta .wq-pill{ padding: .30rem .55rem; }
  }
</style>

{{/* ===== 1) æœ€åæ›´æ–°ï¼šä¼˜å…ˆ Lastmodï¼Œå…¶æ¬¡ Date ===== */}}
{{- $wqLast := (cond (gt (.Lastmod.Unix) 0) (.Lastmod.Format "2006-01-02") (.Date.Format "2006-01-02")) -}}

{{/* ===== 2) é˜…è¯»æ—¶é—´ï¼šä¸­æ–‡æŒ‰â€œå­—æ•°â€ä¼°ç®—ï¼ˆæ›´é€‚åˆä¸­æ–‡ï¼‰ =====
     æ¯åˆ†é’Ÿå­—æ•°ï¼ˆç†è§£å‹é˜…è¯»ï¼‰ï¼šå»ºè®® 380~450
*/}}
{{- $wqMins := .ReadingTime -}}
{{- $lang := lower .Lang -}}
{{- if or (eq $lang "zh-cn") (eq $lang "zh") -}}
  {{- $plain := .Plain -}}
  {{- $noSpace := replaceRE "\\s+" "" $plain -}}
  {{- $chars := len $noSpace -}}
  {{- $wqCPM := 450 -}}  {{/* âœ… è¿™é‡Œæ”¹é€Ÿåº¦ï¼š380(æ›´æ…¢) / 450(é»˜è®¤) / 500(æ›´å¿«) */}}
  {{- $wqMins = div (add $chars (sub $wqCPM 1)) $wqCPM -}} {{/* å‘ä¸Šå–æ•´ */}}
  {{- if lt $wqMins 1 -}}{{- $wqMins = 1 -}}{{- end -}}
{{- end -}}

{{/* ===== 3) è¾“å‡ºç»™ JSï¼š "YYYY-MM-DD|mins" ===== */}}
{{- $wqMeta := (printf "%s|%d" $wqLast $wqMins) | jsonify -}}

<script>
(function(){
  document.addEventListener("DOMContentLoaded", function(){
    var h1 = document.querySelector("article h1");
    if(!h1) return;

    // é˜²é‡å¤æ’å…¥
    if(document.querySelector(".hx-article-meta")) return;

    // Hugo è¾“å‡º JSON å­—ç¬¦ä¸²ï¼š "2026-01-07|5"
    var raw = JSON.parse({{ $wqMeta }});
    var parts = String(raw).split("|");
    var last = parts[0] || "";
    var mins = parts[1] || "";

    var meta = document.createElement("div");
    meta.className = "hx-article-meta";
    meta.innerHTML =
      '<span class="wq-pill" role="note">' +
        '<span class="wq-dot" aria-hidden="true"></span>' +
        '<span class="wq-key">æœ€åæ›´æ–°</span>' +
        '<span class="wq-val">' + last + '</span>' +
      '</span>' +
      '<span class="wq-pill" role="note">' +
        '<span class="wq-key">é˜…è¯»</span>' +
        '<span class="wq-val">çº¦ ' + mins + ' åˆ†é’Ÿ</span>' +
      '</span>';

    h1.insertAdjacentElement("afterend", meta);
  });
})();
</script>
<!-- ===== WQ: inject article meta end ===== -->
{{- end -}}



<!-- ===== WQ Mobile Main Menu Drawer (Hextra) ===== -->
<style>
  /* 1) è®©å³ä¸Šè§’æ±‰å ¡æŒ‰é’®æ›´â€œå›¾æ ‡åŒ–â€ï¼Œå»æ‰æ–¹æ¡†æ„Ÿï¼ˆåªå½±å“ç§»åŠ¨ç«¯ï¼‰ */
  @media (max-width: 768px) {
    button.hextra-hamburger-menu {
      background: transparent !important;
      border: 0 !important;
      box-shadow: none !important;
      border-radius: 12px !important;
      padding: 6px !important;
    }
    button.hextra-hamburger-menu:hover {
      background: rgba(0,0,0,.04) !important;
    }
    html.dark button.hextra-hamburger-menu:hover {
      background: rgba(255,255,255,.06) !important;
    }
  }

  /* 2) æŠ½å±‰é®ç½© + æŠ½å±‰æœ¬ä½“ */
  .wq-mobile-menu-mask{
    position: fixed;
    inset: 0;
    z-index: 9999;
    display: none;
    background: rgba(0,0,0,.28);
    backdrop-filter: blur(8px);
    -webkit-backdrop-filter: blur(8px);
  }
  .wq-mobile-menu-mask.show{ display:block; }

  .wq-mobile-menu-sheet{
    position: absolute;
    top: 0;
    right: 0;
    height: 100%;
    width: min(86vw, 380px);
    background: rgba(255,255,255,.92);
    border-left: 1px solid rgba(0,0,0,.08);
    box-shadow: -18px 0 50px rgba(0,0,0,.18);
    transform: translateX(12px);
    opacity: 0;
    transition: transform .18s ease, opacity .18s ease;
    display: flex;
    flex-direction: column;
    gap: 12px;
    padding: 14px 14px 16px;
  }
  .wq-mobile-menu-mask.show .wq-mobile-menu-sheet{
    transform: translateX(0);
    opacity: 1;
  }

  html.dark .wq-mobile-menu-sheet{
    background: rgba(24,24,27,.92);
    border-left-color: rgba(255,255,255,.10);
    box-shadow: -18px 0 60px rgba(0,0,0,.45);
  }

  /* 3) é¡¶éƒ¨æ ï¼šæ ‡é¢˜ + å…³é—­æŒ‰é’® */
  .wq-mm-head{
    display:flex;
    align-items:center;
    justify-content:space-between;
    gap: 10px;
    padding: 2px 2px 6px;
    border-bottom: 1px solid rgba(0,0,0,.06);
  }
  html.dark .wq-mm-head{ border-bottom-color: rgba(255,255,255,.08); }

  .wq-mm-title{
    font-size: 18px;
    font-weight: 750; /* ä¸è¦å¾ˆé‡ */
    color: rgba(15,23,42,.92);
    letter-spacing: .2px;
  }
  html.dark .wq-mm-title{ color: rgba(255,255,255,.92); }

  .wq-mm-close{
    width: 38px;
    height: 38px;
    border-radius: 14px;
    border: 1px solid rgba(0,0,0,.08);
    background: rgba(255,255,255,.55);
    display:grid;
    place-items:center;
    cursor:pointer;
    transition: background .15s ease, transform .15s ease;
  }
  .wq-mm-close:hover{ background: rgba(255,255,255,.80); transform: scale(1.02); }
  html.dark .wq-mm-close{
    border-color: rgba(255,255,255,.12);
    background: rgba(255,255,255,.06);
  }
  html.dark .wq-mm-close:hover{ background: rgba(255,255,255,.10); }

  /* 4) æœç´¢æ¡†ï¼ˆæ ·å¼å‚è€ƒä½ ç»™çš„æˆªå›¾ï¼‰ */
  .wq-mm-search{
    margin-top: 10px;
    display:flex;
    align-items:center;
    gap: 10px;
    padding: 12px 12px;
    border-radius: 16px;
    border: 1px solid rgba(0,0,0,.10);
    background: rgba(255,255,255,.70);
    cursor: pointer;
    user-select:none;
  }
  .wq-mm-search:hover{ background: rgba(255,255,255,.86); }
  html.dark .wq-mm-search{
    border-color: rgba(255,255,255,.12);
    background: rgba(255,255,255,.06);
  }
  html.dark .wq-mm-search:hover{ background: rgba(255,255,255,.09); }

  .wq-mm-search .hint{
    margin-left: auto;
    display:inline-flex;
    align-items:center;
    gap: 6px;
    padding: 6px 10px;
    border-radius: 12px;
    border: 1px solid rgba(0,0,0,.10);
    background: rgba(255,255,255,.70);
    font-size: 12px;
    font-weight: 650;
    color: rgba(15,23,42,.70);
  }
  html.dark .wq-mm-search .hint{
    border-color: rgba(255,255,255,.12);
    background: rgba(255,255,255,.06);
    color: rgba(255,255,255,.78);
  }
  .wq-mm-search .ph{
    color: rgba(100,116,139,1);
    font-size: 15px;
    font-weight: 650;
  }
  html.dark .wq-mm-search .ph{ color: rgba(209,213,219,.78); }

  /* 5) åˆ—è¡¨é¡¹ï¼ˆå¡ç‰‡å¼ã€è½»åé¦ˆã€ä¸åŠ ç²—ï¼‰ */
  .wq-mm-list{
    display:flex;
    flex-direction: column;
    gap: 12px;
    padding: 6px 0 0;
    overflow: auto;
  }

  .wq-mm-item{
    display:flex;
    align-items:center;
    justify-content:space-between;
    gap: 10px;
    padding: 14px 14px;
    border-radius: 16px;
    border: 1px solid rgba(0,0,0,.10);
    background: rgba(255,255,255,.60);
    text-decoration:none !important;
    color: rgba(15,23,42,.88);
    transition: background .15s ease, border-color .15s ease, transform .15s ease;
  }
  .wq-mm-item:hover{
    background: rgba(37,99,235,.04);
    border-color: rgba(37,99,235,.18);
    transform: translateY(-1px);
  }
  html.dark .wq-mm-item{
    border-color: rgba(255,255,255,.12);
    background: rgba(255,255,255,.06);
    color: rgba(255,255,255,.90);
  }
  html.dark .wq-mm-item:hover{
    background: rgba(96,165,250,.10);
    border-color: rgba(96,165,250,.20);
  }

  .wq-mm-left{
    display:flex;
    align-items:center;
    gap: 12px;
    min-width:0;
  }

  .wq-mm-label{
    font-size: 16px;
    font-weight: 650; /* ä¸è¦åŠ ç²—åˆ° 800+ */
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
  }

  .wq-mm-arrow{
    opacity: .55;
    font-size: 18px;
  }

  /* 6) å°å±ï¼šç¨å¾®æ›´ç´§å‡‘ */
  @media (max-width: 380px){
    .wq-mobile-menu-sheet{ width: min(90vw, 360px); }
    .wq-mm-item{ padding: 12px 12px; }
    .wq-mm-label{ font-size: 15px; }
  }
</style>

<script>
(function(){
  // åªåœ¨ç§»åŠ¨ç«¯å¯ç”¨ï¼ˆé¿å…æ¡Œé¢ç«¯å¹²æ‰°ï¼‰
  function isMobile() {
    return window.matchMedia && window.matchMedia("(max-width: 768px)").matches;
  }

  // ---------- SVG å›¾æ ‡ï¼ˆçº¯çº¿æ¡ï¼Œå’Œä½ æˆªå›¾é£æ ¼æ¥è¿‘ï¼‰ ----------
  function icon(name){
    const common = 'width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"';
    if(name === "home") return `<svg ${common}><path d="M3 10.5 12 3l9 7.5"/><path d="M5 10.5V21h14V10.5"/></svg>`;
    if(name === "doc") return `<svg ${common}><path d="M14 2H7a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V7z"/><path d="M14 2v5h5"/></svg>`;
    if(name === "cloud") return `<svg ${common}><path d="M20 17.5a4.5 4.5 0 0 0-1.1-8.9A6 6 0 0 0 7.2 9.9 4 4 0 0 0 7 17.5h13z"/></svg>`;
    if(name === "user") return `<svg ${common}><path d="M20 21a8 8 0 1 0-16 0"/><circle cx="12" cy="7" r="3"/></svg>`;
    if(name === "mail") return `<svg ${common}><path d="M4 6h16v12H4z"/><path d="m4 7 8 6 8-6"/></svg>`;
    if(name === "github") return `<svg ${common}><path d="M9 19c-4 1.5-4-2.5-5-3"/><path d="M14 22v-3.3a3.2 3.2 0 0 0-.9-2.5c3-.3 6.1-1.5 6.1-6.8a5.3 5.3 0 0 0-1.4-3.6 5 5 0 0 0-.1-3.6s-1.2-.4-3.7 1.4a12.8 12.8 0 0 0-6.6 0C4.9 2.6 3.7 3 3.7 3a5 5 0 0 0-.1 3.6 5.3 5.3 0 0 0-1.4 3.6c0 5.3 3.1 6.5 6.1 6.8a3.2 3.2 0 0 0-.9 2.5V22"/></svg>`;
    if(name === "x") return `<svg ${common}><path d="M4 4l16 16"/><path d="M20 4L4 20"/></svg>`;
    if(name === "search") return `<svg ${common}><circle cx="11" cy="11" r="7"/><path d="M21 21l-4.3-4.3"/></svg>`;
    return `<svg ${common}><circle cx="12" cy="12" r="9"/></svg>`;
  }

  // ---------- åˆ›å»º/è·å–æŠ½å±‰ DOM ----------
  function ensureDrawer(){
    let mask = document.getElementById("wqMobileMenu");
    if(mask) return mask;

    mask = document.createElement("div");
    mask.id = "wqMobileMenu";
    mask.className = "wq-mobile-menu-mask";
    mask.setAttribute("aria-hidden","true");

    mask.innerHTML = `
      <div class="wq-mobile-menu-sheet" role="dialog" aria-modal="true" aria-label="å¯¼èˆª">
        <div class="wq-mm-head">
          <div class="wq-mm-title">å¯¼èˆª</div>
          <button class="wq-mm-close" type="button" aria-label="å…³é—­">
            ${icon("x")}
          </button>
        </div>

        <!-- æœç´¢ -->
        <div class="wq-mm-search" role="button" tabindex="0" aria-label="æœç´¢æ–‡æ¡£">
          ${icon("search")}
          <div class="ph">æœç´¢æ–‡æ¡£â€¦</div>
          <div class="hint"><span>âŒ˜</span><span>K</span></div>
        </div>

        <!-- èœå•åˆ—è¡¨ï¼ˆJS å¡«å……ï¼‰ -->
        <div class="wq-mm-list" id="wqMmList"></div>
      </div>
    `;
    document.body.appendChild(mask);
    return mask;
  }

  // ä»æ¡Œé¢å¯¼èˆªæ â€œå¤åˆ¶â€èœå•é¡¹ï¼ˆè¿™æ ·ä½  hugo.yaml çš„ menu å˜äº†ï¼Œè¿™é‡Œä¹Ÿè·Ÿç€å˜ï¼‰
  function readTopNavLinks(){
    // Hextra é¡¶éƒ¨ nav é‡Œèƒ½çœ‹åˆ° <nav class="hextra-max-navbar-width ..."> é‡Œé¢çš„ <a>
    const nav = document.querySelector("nav.hextra-max-navbar-width");
    if(!nav) return [];
    const links = Array.from(nav.querySelectorAll("a[href]"))
      .map(a => ({
        text: (a.textContent || "").trim(),
        href: a.getAttribute("href") || "",
        title: a.getAttribute("title") || ""
      }))
      // è¿‡æ»¤æ‰ç©ºæ–‡æœ¬ã€åªå‰©å›¾æ ‡çš„ï¼ˆæ¯”å¦‚ GitHub/X å›¾æ ‡é€šå¸¸æ²¡æœ‰æ–‡å­—ï¼Œä½† title æœ‰ï¼‰
      .filter(x => x.href && (x.text || x.title));

    // ä½ æƒ³è¦é¡ºåºï¼šä¸»é¡µ-åšå®¢-å…³äº-GitHub-email-æœç´¢æ¡†
    // è¿™é‡Œç”¨å…³é”®è¯è¿›è¡Œæ’åºï¼ˆå°½é‡ç¨³ï¼Œä¸ç¡¬ç¼–ç ä½ ç«™ç‚¹åŸŸåï¼‰
    const pick = (kw) => links.find(x => (x.text + " " + x.title).toLowerCase().includes(kw));
    const result = [];

    const home = links.find(x => x.href === "/" || x.href === "");
    if(home) result.push({label:"é¦–é¡µ", href:"/", icon:"home"});

    // æ–‡æ¡£ï¼ˆdocsï¼‰
    const docs = pick("docs") || pick("æ–‡æ¡£");
    if(docs) result.push({label:"æ–‡æ¡£", href: docs.href, icon:"doc"});

    // ç½‘ç›˜ï¼ˆpanï¼‰
    const pan = pick("pan") || pick("ç½‘ç›˜");
    if(pan) result.push({label:"ç½‘ç›˜", href: pan.href, icon:"cloud", external:true});

    // å…³äº
    const about = pick("about") || pick("å…³äº");
    if(about) result.push({label:"å…³äº", href: about.href, icon:"user"});

    // è”ç³»ï¼ˆmailtoï¼‰
    const mail = links.find(x => (x.href || "").startsWith("mailto:")) || pick("è”ç³»");
    if(mail) result.push({label:"è”ç³»", href: mail.href, icon:"mail", external:true});

    // GitHub
    const gh = pick("github");
    if(gh) result.push({label:"GitHub", href: gh.href, icon:"github", external:true});

    // Twitter / X
    const tw = pick("twitter") || pick("x.com") || pick("x ");
    if(tw) result.push({label:"Twitter", href: tw.href, icon:"x", external:true});

    // å»é‡ï¼ˆæŒ‰ hrefï¼‰
    const seen = new Set();
    return result.filter(it => {
      if(seen.has(it.href)) return false;
      seen.add(it.href);
      return true;
    });
  }

  function renderList(mask){
    const list = mask.querySelector("#wqMmList");
    if(!list) return;

    const items = readTopNavLinks();

    list.innerHTML = items.map(it => {
      const target = it.external ? ` target="_blank" rel="noopener noreferrer"` : "";
      return `
        <a class="wq-mm-item" href="${it.href}"${target}>
          <div class="wq-mm-left">
            ${icon(it.icon)}
            <div class="wq-mm-label">${it.label}</div>
          </div>
          <div class="wq-mm-arrow">â€º</div>
        </a>
      `;
    }).join("");
  }

  // ---------- æ‰“å¼€/å…³é—­ ----------
  function openDrawer(){
    const mask = ensureDrawer();
    renderList(mask);

    mask.classList.add("show");
    mask.setAttribute("aria-hidden","false");
    document.documentElement.style.overflow = "hidden";
  }

  function closeDrawer(){
    const mask = document.getElementById("wqMobileMenu");
    if(!mask) return;

    mask.classList.remove("show");
    mask.setAttribute("aria-hidden","true");
    document.documentElement.style.overflow = "";
  }

  // ---------- è§¦å‘ Hextra åŸç”Ÿæœç´¢ ----------
  function openHextraSearch(){
    // 1) ä¼˜å…ˆï¼šèšç„¦çœŸå® input.hextra-search-input
    const input = document.querySelector("input.hextra-search-input");
    if(input){
      input.focus();
      input.click();
      return true;
    }

    // 2) é€€åŒ–ï¼šæ¨¡æ‹Ÿ Ctrl/âŒ˜ + K
    const isMac = /Mac|iPhone|iPad|iPod/.test(navigator.platform);
    const evt = new KeyboardEvent("keydown", {
      key: "k",
      code: "KeyK",
      metaKey: isMac,
      ctrlKey: !isMac,
      bubbles: true
    });
    document.dispatchEvent(evt);
    return true;
  }

  function bind(){
    if(!isMobile()) return;

    // ç»‘å®šï¼šåŸç”Ÿæ±‰å ¡æŒ‰é’® -> æ‰“å¼€æˆ‘ä»¬çš„æŠ½å±‰
    const btn = document.querySelector("button.hextra-hamburger-menu");
    if(btn && !btn.dataset.wqBound){
      btn.dataset.wqBound = "1";
      btn.addEventListener("click", function(e){
        e.preventDefault();
        e.stopPropagation();
        openDrawer();
      }, true);
    }

    const mask = ensureDrawer();

    // ç‚¹å‡»é®ç½©ç©ºç™½å…³é—­
    mask.addEventListener("click", function(e){
      if(e.target === mask) closeDrawer();
    });

    // å…³é—­æŒ‰é’®
    const closeBtn = mask.querySelector(".wq-mm-close");
    if(closeBtn){
      closeBtn.addEventListener("click", function(e){
        e.preventDefault();
        e.stopPropagation();
        closeDrawer();
      });
    }

    // ESC å…³é—­ï¼ˆæ¡Œé¢è°ƒè¯•ä¹Ÿæœ‰ç”¨ï¼‰
    document.addEventListener("keydown", function(e){
      if(e.key === "Escape"){
        const m = document.getElementById("wqMobileMenu");
        if(m && m.classList.contains("show")) closeDrawer();
      }
    });

    // æœç´¢åŒºåŸŸï¼šä¸è¦è®©äº‹ä»¶å†’æ³¡åˆ°é®ç½©ï¼ˆå¦åˆ™ä¼šè¢«å…³é—­ï¼‰
    const searchBox = mask.querySelector(".wq-mm-search");
    if(searchBox){
      const handler = function(e){
        e.preventDefault();
        e.stopPropagation();

        closeDrawer();
        // ç¨ç­‰åŠ¨ç”»å®Œæˆï¼Œå†æ‰“å¼€æœç´¢
        setTimeout(function(){
          openHextraSearch();
        }, 180);
      };

      searchBox.addEventListener("click", handler);
      searchBox.addEventListener("touchstart", function(e){
        // iOS ä¸Šæ›´ç¨³
        e.stopPropagation();
      }, {passive:true});
      searchBox.addEventListener("keydown", function(e){
        if(e.key === "Enter" || e.key === " "){
          handler(e);
        }
      });
    }
  }

  // åˆæ¬¡ç»‘å®š + è·¯ç”±åˆ‡æ¢åä¹Ÿå°è¯•ç»‘å®šï¼ˆHextra æœ‰äº›é¡µé¢æ˜¯å±€éƒ¨æ¸²æŸ“ï¼‰
  function init(){
    bind();
    // ç®€å•ç›‘å¬ï¼šç‚¹å‡»å 300ms å† bind ä¸€æ¬¡ï¼Œè¦†ç›–â€œé¡µé¢å†…è·³è½¬â€
    document.addEventListener("click", function(){
      setTimeout(bind, 300);
    }, {passive:true});
  }

  if(document.readyState === "loading"){
    document.addEventListener("DOMContentLoaded", init);
  }else{
    init();
  }
})();
</script>
<!-- ===== WQ Mobile Main Menu Drawer end ===== -->