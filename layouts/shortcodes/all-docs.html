{{/* ========= 每页数量（默认 5，可通过 perpage 覆盖） ========= */}}
{{- $perPage := 5 -}}
{{- with .Get "perpage" -}}
  {{- $perPage = (int .) -}}
{{- end -}}

{{/* ========= Docs 数据源 ========= */}}
{{- $pages := where site.RegularPages "Section" "docs" -}}

{{/* ========= ✅ 关键修复：shortcode 里必须用 .Page.Paginate ========= */}}
{{- $p := .Page.Paginate ($pages.ByDate.Reverse) $perPage -}}

<style>
/* ================= 文章列表（保持你原 UI） ================= */
.wq-doc-list{ margin-top: 14px; }

.wq-doc-item{
  display:block;
  border: 1px solid rgba(0,0,0,.06);
  border-radius: 16px;
  padding: 14px 16px;
  margin: 10px 0;
  background: rgba(255,255,255,.7);
  box-shadow: 0 10px 22px rgba(15,23,42,.06);
  text-decoration:none !important;
  transition: transform .15s ease, box-shadow .15s ease, background .15s ease, border-color .15s ease;
}
.wq-doc-item:hover{
  transform: translateY(-2px);
  background: rgba(37,99,235,.05);
  border-color: rgba(37,99,235,.18);
  box-shadow: 0 14px 30px rgba(15,23,42,.10);
}

.wq-doc-top{
  display:flex;
  align-items:center;
  gap: 10px;
  flex-wrap: wrap;
}
.wq-doc-dot{
  width: 10px;
  height: 10px;
  border-radius: 999px;
  background: rgba(37,99,235,.60);
  box-shadow: 0 0 0 4px rgba(37,99,235,.10);
}
.wq-doc-date{
  font-size: 12px;
  color: rgba(100,116,139,1);
  padding: 2px 8px;
  border-radius: 999px;
  background: rgba(148,163,184,.16);
  font-variant-numeric: tabular-nums;
}
.wq-doc-title{
  font-weight: 800;
  font-size: 16px;
}
.wq-doc-desc{
  margin-top: 8px;
  color: rgba(100,116,139,1);
  font-size: 13px;
  line-height: 1.6;
}

/* ================= 分页（简洁蓝色） ================= */
.wq-pager{
  display:flex;
  gap:10px;
  justify-content:center;
  margin: 28px 0 12px;
  flex-wrap: wrap;
}

.wq-pagebtn{
  min-width: 44px;
  padding: 8px 14px;
  border-radius: 12px;
  border: 1px solid rgba(0,0,0,.08);
  background: rgba(255,255,255,.85);
  color: #2563eb;
  font-weight: 600;
  font-size: 14px;
  text-align:center;
  text-decoration:none !important;
  transition: background .15s ease, border-color .15s ease;
}
.wq-pagebtn:hover{
  background: rgba(37,99,235,.10);
  border-color: rgba(37,99,235,.30);
}
.wq-pagebtn.is-active{
  background: #2563eb;
  color: #fff;
  border-color: #2563eb;
  pointer-events:none;
}
.wq-pagebtn.is-disabled{
  opacity: .45;
  pointer-events:none;
}

/* ================= 暗色模式 ================= */
@media (prefers-color-scheme: dark){
  .wq-doc-item{
    background: rgba(24,24,27,.55);
    border-color: rgba(255,255,255,.10);
    box-shadow: 0 16px 40px rgba(0,0,0,.35);
  }
  .wq-doc-item:hover{
    background: rgba(96,165,250,.10);
    border-color: rgba(96,165,250,.22);
  }
  .wq-doc-date{
    background: rgba(255,255,255,.08);
    color: rgba(209,213,219,1);
  }
  .wq-doc-desc{
    color: rgba(209,213,219,.80);
  }
  .wq-doc-dot{
    background: rgba(96,165,250,.70);
    box-shadow: 0 0 0 4px rgba(96,165,250,.16);
  }
  .wq-pagebtn{
    background: rgba(24,24,27,.7);
    border-color: rgba(255,255,255,.12);
    color: rgba(147,197,253,1);
  }
  .wq-pagebtn:hover{
    background: rgba(96,165,250,.18);
  }
  .wq-pagebtn.is-active{
    background: rgba(96,165,250,1);
    color:#000;
  }
}
</style>

<div class="wq-doc-list">
  {{ range $p.Pages }}
    <a class="wq-doc-item" href="{{ .RelPermalink }}">
      <div class="wq-doc-top">
        <span class="wq-doc-dot"></span>
        <span class="wq-doc-date">{{ .Date.Format "2006-01-02" }}</span>
        <span class="wq-doc-title">{{ .Title }}</span>
      </div>

      {{ with .Params.description }}
        <div class="wq-doc-desc">{{ . }}</div>
      {{ end }}
    </a>
  {{ end }}
</div>

{{ if gt $p.TotalPages 1 }}
<nav class="wq-pager" aria-label="Pagination">

  {{ if $p.HasPrev }}
    <a class="wq-pagebtn" href="{{ $p.Prev.URL }}">上一页</a>
  {{ else }}
    <span class="wq-pagebtn is-disabled">上一页</span>
  {{ end }}

  {{ range $pager := $p.Pagers }}
    {{ if eq $pager.PageNumber $p.PageNumber }}
      <span class="wq-pagebtn is-active">{{ $pager.PageNumber }}</span>
    {{ else }}
      <a class="wq-pagebtn" href="{{ $pager.URL }}">{{ $pager.PageNumber }}</a>
    {{ end }}
  {{ end }}

  {{ if $p.HasNext }}
    <a class="wq-pagebtn" href="{{ $p.Next.URL }}">下一页</a>
  {{ else }}
    <span class="wq-pagebtn is-disabled">下一页</span>
  {{ end }}

</nav>
{{ end }}
